<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多言語対応チャットボット デモ</title>
    
    <!-- Tailwind CSSとGoogle Fontsの読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* フォント設定 */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* スクロールバーのスタイル */
        #chat-window::-webkit-scrollbar {
            width: 8px;
        }
        #chat-window::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        #chat-window::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }
        #chat-window::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>

<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-lg mx-4 bg-white rounded-2xl shadow-2xl flex flex-col h-[90vh] max-h-[700px]">
        
        <!-- ヘッダー部分 -->
        <header class="bg-blue-600 text-white p-4 rounded-t-2xl shadow-md flex justify-between items-center">
            <div>
                <h1 id="header-title" class="text-xl font-bold">多言語チャットボット</h1>
                <p id="header-lang-status" class="text-sm opacity-80">言語: 日本語</p>
            </div>
            <!-- 言語選択ボタン -->
            <div id="language-switcher" class="flex space-x-2">
                <button onclick="switchLanguage('ja')" class="ja-btn bg-white text-blue-600 font-bold py-1 px-3 rounded-full text-sm shadow-sm transition-transform transform scale-110 ring-2 ring-white">日本語</button>
                <button onclick="switchLanguage('en')" class="en-btn bg-blue-500 hover:bg-white hover:text-blue-600 font-bold py-1 px-3 rounded-full text-sm shadow-sm transition-transform transform hover:scale-110">EN</button>
            </div>
        </header>

        <!-- チャットウィンドウ -->
        <main id="chat-window" class="flex-1 p-6 overflow-y-auto space-y-4 bg-gray-50">
            <!-- メッセージはここに動的に追加されます -->
        </main>

        <!-- 入力フォーム部分 -->
        <footer class="p-4 bg-white border-t border-gray-200 rounded-b-2xl">
            <div class="flex items-center space-x-3">
                <input type="text" id="user-input" class="flex-1 p-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 transition" placeholder="メッセージを入力...">
                <button id="send-btn" class="bg-blue-600 text-white rounded-full p-3 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-transform transform hover:scale-110">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                </button>
            </div>
        </footer>
    </div>

<script>
    // --- グローバル変数定義 ---
    let currentLanguage = 'ja';

    // --- DOM要素の取得 ---
    const chatWindow = document.getElementById('chat-window');
    const userInput = document.getElementById('user-input');
    const sendBtn = document.getElementById('send-btn');
    const langSwitcher = document.getElementById('language-switcher');
    
    // --- 多言語対応データ ---
    // UIのテキストを管理
    const uiStrings = {
        ja: {
            headerTitle: '多言語チャットボット',
            langStatus: '言語: 日本語',
            inputPlaceholder: 'メッセージを入力...',
            welcomeMessage: 'こんにちは！ご用件は何ですか？以下のボタンから選択するか、テキストで入力してください。',
            quickReplies: ['サービス', '料金', '営業時間'],
        },
        en: {
            headerTitle: 'Multilingual Chatbot',
            langStatus: 'Language: English',
            inputPlaceholder: 'Enter a message...',
            welcomeMessage: 'Hello! How can I help you? Please select from the buttons below or type your question.',
            quickReplies: ['Services', 'Price', 'Hours'],
        }
    };

    // チャットボットの応答ロジック
    const botResponses = {
        ja: {
            'default': '申し訳ありません、よく理解できませんでした。別の言葉で試していただけますか？',
            'こんにちは': 'こんにちは！何かお探しですか？',
            'ありがとう': 'どういたしまして！',
            'サービス': '当社のサービスには、Webサイト制作、システム開発、コンサルティングなどがあります。',
            '料金': '料金については、プロジェクトの規模により異なります。まずはお気軽にお問い合わせください。',
            '営業時間': '営業時間は平日の午前9時から午後6時までです。'
        },
        en: {
            'default': "I'm sorry, I couldn't understand that. Could you please try rephrasing?",
            'hello': 'Hello! How can I assist you?',
            'thank you': 'You\'re welcome!',
            'services': 'We offer various services including website creation, system development, and consulting.',
            'price': 'Pricing depends on the project scope. Please feel free to contact us for a quote.',
            'hours': 'Our business hours are from 9:00 AM to 6:00 PM on weekdays.'
        }
    };
    
    // --- 関数定義 ---

    /**
     * 言語を切り替える関数
     * @param {string} lang - 切り替え先の言語コード ('ja' or 'en')
     */
    function switchLanguage(lang) {
        currentLanguage = lang;
        
        // UIテキストの更新
        document.getElementById('header-title').textContent = uiStrings[lang].headerTitle;
        document.getElementById('header-lang-status').textContent = uiStrings[lang].langStatus;
        userInput.placeholder = uiStrings[lang].inputPlaceholder;

        // ボタンのスタイル更新
        const buttons = langSwitcher.querySelectorAll('button');
        buttons.forEach(btn => {
            btn.classList.remove('bg-white', 'text-blue-600', 'scale-110', 'ring-2', 'ring-white');
            btn.classList.add('bg-blue-500', 'hover:bg-white', 'hover:text-blue-600');
            if (btn.classList.contains(`${lang}-btn`)) {
                btn.classList.add('bg-white', 'text-blue-600', 'scale-110', 'ring-2', 'ring-white');
                btn.classList.remove('bg-blue-500', 'hover:bg-white', 'hover:text-blue-600');
            }
        });

        // チャット履歴をクリアしてウェルカムメッセージを表示
        chatWindow.innerHTML = '';
        displayBotMessage(uiStrings[lang].welcomeMessage, uiStrings[lang].quickReplies);
    }
    
    /**
     * チャットウィンドウにメッセージを追加する関数
     * @param {string} text - 表示するメッセージ
     * @param {string} sender - 送信者 ('user' or 'bot')
     */
    function addMessageToWindow(text, sender) {
        const messageDiv = document.createElement('div');
        messageDiv.className = `flex ${sender === 'user' ? 'justify-end' : 'justify-start'}`;
        
        const bubble = document.createElement('div');
        bubble.className = `max-w-xs md:max-w-md lg:max-w-lg p-3 rounded-2xl shadow`;
        bubble.textContent = text;
        
        if (sender === 'user') {
            bubble.classList.add('bg-blue-600', 'text-white');
        } else {
            bubble.classList.add('bg-white', 'text-gray-800');
        }
        
        messageDiv.appendChild(bubble);
        chatWindow.appendChild(messageDiv);
        
        // 最新のメッセージが見えるようにスクロール
        chatWindow.scrollTop = chatWindow.scrollHeight;
    }

    /**
     * ボットのメッセージとクイック返信ボタンを表示する関数
     * @param {string} text - 表示するメッセージ
     * @param {string[]} [replies] - (任意) クイック返信の選択肢
     */
    function displayBotMessage(text, replies = []) {
        addMessageToWindow(text, 'bot');

        if (replies.length > 0) {
            const repliesContainer = document.createElement('div');
            repliesContainer.className = 'flex justify-start flex-wrap gap-2 mt-2';
            
            replies.forEach(replyText => {
                const replyBtn = document.createElement('button');
                replyBtn.textContent = replyText;
                replyBtn.className = 'quick-reply-btn bg-white border border-blue-500 text-blue-500 text-sm font-semibold py-1 px-4 rounded-full hover:bg-blue-500 hover:text-white transition';
                repliesContainer.appendChild(replyBtn);
            });
            chatWindow.appendChild(repliesContainer);
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }
    }
    
    /**
     * ユーザーの入力を処理する関数
     */
    function handleUserInput() {
        const inputText = userInput.value.trim();
        if (!inputText) return;
        
        addMessageToWindow(inputText, 'user');
        userInput.value = '';
        
        // ボットの応答を少し遅らせて表示
        setTimeout(() => {
            getBotResponse(inputText);
        }, 500);
    }

    /**
     * ボットの応答を取得して表示する関数
     * @param {string} text - ユーザーの入力テキスト
     */
    function getBotResponse(text) {
        const lowerCaseText = text.toLowerCase();
        const responses = botResponses[currentLanguage];
        let reply = responses.default;

        // キーワードに完全一致または部分一致する場合に応答を探す
        for (const keyword in responses) {
            if (lowerCaseText.includes(keyword.toLowerCase())) {
                reply = responses[keyword];
                break;
            }
        }
        displayBotMessage(reply);
    }
    
    // --- イベントリスナー ---
    sendBtn.addEventListener('click', handleUserInput);
    userInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            handleUserInput();
        }
    });

    // クイック返信ボタンのクリックイベント（イベント委譲）
    chatWindow.addEventListener('click', function(e) {
        if (e.target.classList.contains('quick-reply-btn')) {
            const replyText = e.target.textContent;
            addMessageToWindow(replyText, 'user');
            
            // 押されたボタンのコンテナを削除
            e.target.parentElement.remove();

            setTimeout(() => {
                getBotResponse(replyText);
            }, 500);
        }
    });
    
    // --- 初期化 ---
    // ページ読み込み時に日本語のウェルカムメッセージを表示
    switchLanguage('ja');

</script>

</body>
</html>
